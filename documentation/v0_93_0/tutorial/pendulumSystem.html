<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Create a pendulum &mdash; trep documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.92-dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="trep documentation" href="../index.html" />
    <link rel="up" title="Tutorial" href="index.html" />
    <link rel="next" title="Design linear feedback controller" href="linearFeedbackController.html" />
    <link rel="prev" title="Trep “Hello World”" href="trepHelloWorld.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="linearFeedbackController.html" title="Design linear feedback controller"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="trepHelloWorld.html" title="Trep “Hello World”"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">trep documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Tutorial</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
    <script type="math/tex">
    \newcommand{\deriv}[2][]{\dfrac{\partial #1}{\partial #2}}
\newcommand{\tderiv}[2][]{\tfrac{\partial #1}{\partial #2}}
\newcommand{\fderiv}[2][]{\dfrac{d #1}{d #2}}
\newcommand{\derivII}[3][]{\dfrac{\partial^2 #1}{\partial #2 \partial #3}}
\newcommand{\tderivII}[3][]{\tfrac{\partial^2 #1}{\partial #2 \partial #3}}
\newcommand{\derivIII}[4][]{\dfrac{\partial^3 #1}{\partial #2 \partial #3 \partial #4}}
\newcommand{\tderivIII}[4][]{\tfrac{\partial^3 #1}{\partial #2 \partial #3 \partial #4}}
\newcommand{\derivIV}[5][]{\dfrac{\partial^4 #1}{\partial #2 \partial #3 \partial #4 \partial #5}}

\newcommand{\half}{\tfrac{1}{2}}  % Macro for 1/2

\newcommand{\ud}{\mathrm{d}}

\newcommand{\op}{\circ}
\newcommand{\dq}{\dot{q}}
\newcommand{\ddq}{\ddot{q}}

\newcommand{\dt}{\Delta t}


    </script>
    
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="create-a-pendulum">
<h1>Create a pendulum<a class="headerlink" href="#create-a-pendulum" title="Permalink to this headline">¶</a></h1>
<p>Now let&#8217;s create a trep model of a simple single-link pendulum, simulate a
discrete trajectory, and then visualize the results.</p>
<div class="section" id="import-necessary-python-modules">
<h2>Import necessary Python modules<a class="headerlink" href="#import-necessary-python-modules" title="Permalink to this headline">¶</a></h2>
<p>Let us begin by importing some standard modules including the trep module into
python.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">pi</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">trep</span>
<span class="hll"><span class="kn">from</span> <span class="nn">trep</span> <span class="kn">import</span> <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">,</span> <span class="n">tz</span><span class="p">,</span> <span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="p">,</span> <span class="n">rz</span>
</span></pre></div>
</div>
<p>The line that should be noted here is highlighted above. <tt class="docutils literal"><span class="pre">tx,</span> <span class="pre">ty,</span> <span class="pre">tz,</span> <span class="pre">rx,</span> <span class="pre">ry,</span>
<span class="pre">rz</span></tt> are trep methods that make it very easy to create new frames of reference
for your system. They are used in the next section.</p>
</div>
<div class="section" id="build-a-pendulum-system">
<h2>Build a pendulum system<a class="headerlink" href="#build-a-pendulum-system" title="Permalink to this headline">¶</a></h2>
<p>Let us now build the pendulum system that corresponds to the figure below.</p>
<img alt="../_images/simplePendulum.png" src="../_images/simplePendulum.png" />
<div class="highlight-python"><div class="highlight"><pre><span class="n">m</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="c"># Mass of pendulum</span>
<span class="n">l</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="c"># Length of pendulum</span>
<span class="n">q0</span> <span class="o">=</span> <span class="mf">3.</span><span class="o">/</span><span class="mf">4.</span><span class="o">*</span><span class="n">pi</span> <span class="c"># Initial configuration of pendulum</span>
<span class="n">t0</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c"># Initial time</span>
<span class="n">tf</span> <span class="o">=</span> <span class="mf">5.0</span> <span class="c"># Final time</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c"># Timestep</span>

<span class="n">system</span> <span class="o">=</span> <span class="n">trep</span><span class="o">.</span><span class="n">System</span><span class="p">()</span> <span class="c"># Initialize system</span>

<span class="n">frames</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">rx</span><span class="p">(</span><span class="s">&#39;theta&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&quot;pendulumShoulder&quot;</span><span class="p">),</span> <span class="p">[</span>
        <span class="n">tz</span><span class="p">(</span><span class="o">-</span><span class="n">l</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&quot;pendulumArm&quot;</span><span class="p">,</span> <span class="n">mass</span><span class="o">=</span><span class="n">m</span><span class="p">)]]</span>
<span class="n">system</span><span class="o">.</span><span class="n">import_frames</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span> <span class="c"># Add frames</span>
</pre></div>
</div>
<p>The first lines of code here define system parameters. Then you can see that a
new trep system is created.</p>
<p>The frames of the system are defined using the methods that were imported
above. The <a class="reference internal" href="../ref/frame.html#trep-frame"><em>Frame</em></a> documentation has a through explanation of
how to create and use these frames. The first frame is created to rotate around
its parent&#8217;s (<tt class="docutils literal"><span class="pre">system.world_frame</span></tt>) X axis. It is defined by the configuration
parameter <tt class="docutils literal"><span class="pre">theta</span></tt> and is named <tt class="docutils literal"><span class="pre">pendulumShoulder</span></tt>. The second frame is a
translation of fixed amount (<tt class="docutils literal"><span class="pre">-l</span></tt>) along its parent&#8217;s (<tt class="docutils literal"><span class="pre">pendulumShoulder</span></tt>) Z
axis and is given a mass of <tt class="docutils literal"><span class="pre">m</span></tt>. The <tt class="docutils literal"><span class="pre">system.import_frames</span></tt> method is used
to create the frames from the list of frame definations in <tt class="docutils literal"><span class="pre">frames</span></tt>.</p>
</div>
<div class="section" id="add-forces-to-the-system">
<h2>Add forces to the system<a class="headerlink" href="#add-forces-to-the-system" title="Permalink to this headline">¶</a></h2>
<p>Let us now add forces, potentials, and damping into the system.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">trep</span><span class="o">.</span><span class="n">potentials</span><span class="o">.</span><span class="n">Gravity</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.8</span><span class="p">))</span> <span class="c"># Add gravity</span>
<span class="n">trep</span><span class="o">.</span><span class="n">forces</span><span class="o">.</span><span class="n">Damping</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="c"># Add damping</span>
<span class="n">trep</span><span class="o">.</span><span class="n">forces</span><span class="o">.</span><span class="n">ConfigForce</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="s">&#39;theta&#39;</span><span class="p">,</span> <span class="s">&#39;theta-torque&#39;</span><span class="p">)</span> <span class="c"># Add input</span>
</pre></div>
</div>
<p>Gravity can work in any direction relative to the world frame. Here it is
assigned to be parallel to the Z axis and have a value of <span class="math">\(-9.8
~m/s^2\)</span>. Trep can handle other types of potentials as well.  See the
<a class="reference internal" href="../ref/potential.html#trep-potential"><em>Potential</em></a> documentation for information on the
<a class="reference internal" href="../ref/potential.html#trep.Potential" title="trep.Potential"><tt class="xref py py-class docutils literal"><span class="pre">trep.Potential</span></tt></a> base class, and see the <a class="reference internal" href="../ref/potentials.html#module-trep.potentials" title="trep.potentials: Built in potential energy types. (Linux, Mac)"><tt class="xref py py-mod docutils literal"><span class="pre">trep.potentials</span></tt></a>
documentation for a list of the potentials that have been implemented.</p>
<p>Damping is applied to the entire system with the <a class="reference internal" href="../ref/damping.html#trep.forces.Damping" title="trep.forces.Damping"><tt class="xref py py-mod docutils literal"><span class="pre">trep.forces.Damping</span></tt></a>
method. Note that trep can also apply unique damping values to individual
configurations or set default values for all configurations &#8211; see the
<a class="reference internal" href="../ref/damping.html#trep-force-damping"><em>Damping</em></a> documentation.</p>
<p>An input is configured for the system by adding a configuration force with the
<a class="reference internal" href="../ref/configforce.html#trep.forces.ConfigForce" title="trep.forces.ConfigForce"><tt class="xref py py-mod docutils literal"><span class="pre">trep.forces.ConfigForce</span></tt></a> method. Specifically this adds an input to the
configuration variable <tt class="docutils literal"><span class="pre">theta</span></tt> (the configuration variable for the
<tt class="docutils literal"><span class="pre">pendulumShoulder</span></tt> frame) with the name <tt class="docutils literal"><span class="pre">theta-torque</span></tt>.  See <a class="reference internal" href="../ref/forces.html#builtin-forces"><em>Forces</em></a> for a list of the available force types, and
<a class="reference internal" href="../ref/force.html#trep.Force" title="trep.Force"><tt class="xref py py-class docutils literal"><span class="pre">trep.Force</span></tt></a> for the documentation on the base class.</p>
</div>
<div class="section" id="create-and-initialize-the-variational-integrator">
<h2>Create and initialize the variational integrator<a class="headerlink" href="#create-and-initialize-the-variational-integrator" title="Permalink to this headline">¶</a></h2>
<p>Trep uses variational integrators to simulate the dynamics of mechanical
systems.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">mvi</span> <span class="o">=</span> <span class="n">trep</span><span class="o">.</span><span class="n">MidpointVI</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
<span class="n">mvi</span><span class="o">.</span><span class="n">initialize_from_configs</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">q0</span><span class="p">]),</span> <span class="n">t0</span><span class="o">+</span><span class="n">dt</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">q0</span><span class="p">]))</span>
</pre></div>
</div>
<p>Here a new variational integrator object <tt class="docutils literal"><span class="pre">mvi</span></tt> is created using our <tt class="docutils literal"><span class="pre">system</span></tt>
instance of a <a class="reference internal" href="../ref/system.html#trep.System" title="trep.System"><tt class="xref py py-class docutils literal"><span class="pre">trep.System</span></tt></a>. It is then initialized with a set of two
time points and configurations using
<a class="reference internal" href="../ref/midpointvi.html#trep.MidpointVI.initialize_from_configs" title="trep.MidpointVI.initialize_from_configs"><tt class="xref py py-mod docutils literal"><span class="pre">trep.MidpointVI.initialize_from_configs</span></tt></a>. The first two arguments are the
current time and configuration and the next two are the next time and
configuration. Trep calculates the discrete generalized momentum from these two
pairs. You can also initialize the variational integrator with a single time,
configuration, and momentum using the
<a class="reference internal" href="../ref/midpointvi.html#trep.MidpointVI.initialize_from_state" title="trep.MidpointVI.initialize_from_state"><tt class="xref py py-mod docutils literal"><span class="pre">trep.MidpointVI.initialize_from_state</span></tt></a> method.</p>
<p>Here is a list of all the properties and methods of the variational integrator.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">mvi</span><span class="o">.</span>
<span class="go">mvi.calc_f                   mvi.nk                       mvi.q2_dk2dk2</span>
<span class="go">mvi.calc_p2                  mvi.nq                       mvi.q2_dp1</span>
<span class="go">mvi.discrete_fm2             mvi.nu                       mvi.q2_dp1dk2</span>
<span class="go">mvi.initialize_from_configs  mvi.p1                       mvi.q2_dp1dp1</span>
<span class="go">mvi.initialize_from_state    mvi.p2                       mvi.q2_dp1du1</span>
<span class="go">mvi.lambda1                  mvi.p2_dk2                   mvi.q2_dq1</span>
<span class="go">mvi.lambda1_dk2              mvi.p2_dk2dk2                mvi.q2_dq1dk2</span>
<span class="go">mvi.lambda1_dk2dk2           mvi.p2_dp1                   mvi.q2_dq1dp1</span>
<span class="go">mvi.lambda1_dp1              mvi.p2_dp1dk2                mvi.q2_dq1dq1</span>
<span class="go">mvi.lambda1_dp1dk2           mvi.p2_dp1dp1                mvi.q2_dq1du1</span>
<span class="go">mvi.lambda1_dp1dp1           mvi.p2_dp1du1                mvi.q2_du1</span>
<span class="go">mvi.lambda1_dp1du1           mvi.p2_dq1                   mvi.q2_du1dk2</span>
<span class="go">mvi.lambda1_dq1              mvi.p2_dq1dk2                mvi.q2_du1du1</span>
<span class="go">mvi.lambda1_dq1dk2           mvi.p2_dq1dp1                mvi.set_midpoint</span>
<span class="go">mvi.lambda1_dq1dp1           mvi.p2_dq1dq1                mvi.step</span>
<span class="go">mvi.lambda1_dq1dq1           mvi.p2_dq1du1                mvi.system</span>
<span class="go">mvi.lambda1_dq1du1           mvi.p2_du1                   mvi.t1</span>
<span class="go">mvi.lambda1_du1              mvi.p2_du1dk2                mvi.t2</span>
<span class="go">mvi.lambda1_du1dk2           mvi.p2_du1du1                mvi.tolerance</span>
<span class="go">mvi.lambda1_du1du1           mvi.q1                       mvi.u1</span>
<span class="go">mvi.nc                       mvi.q2                       mvi.v2</span>
<span class="go">mvi.nd                       mvi.q2_dk2</span>
</pre></div>
</div>
</div>
<div class="section" id="simulate-the-system-forward">
<h2>Simulate the system forward<a class="headerlink" href="#simulate-the-system-forward" title="Permalink to this headline">¶</a></h2>
<p>Let us now simulate this system forward in time.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">T</span> <span class="o">=</span> <span class="p">[</span><span class="n">mvi</span><span class="o">.</span><span class="n">t1</span><span class="p">]</span> <span class="c"># List to hold time values</span>
<span class="n">Q</span> <span class="o">=</span> <span class="p">[</span><span class="n">mvi</span><span class="o">.</span><span class="n">q1</span><span class="p">]</span> <span class="c"># List to hold configuration values</span>
<span class="k">while</span> <span class="n">mvi</span><span class="o">.</span><span class="n">t1</span> <span class="o">&lt;</span> <span class="n">tf</span><span class="p">:</span>
    <span class="n">mvi</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">mvi</span><span class="o">.</span><span class="n">t2</span><span class="o">+</span><span class="n">dt</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">])</span> <span class="c"># Step the system forward by one time step</span>
    <span class="n">T</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mvi</span><span class="o">.</span><span class="n">t1</span><span class="p">)</span>
    <span class="n">Q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mvi</span><span class="o">.</span><span class="n">q1</span><span class="p">)</span>
</pre></div>
</div>
<p>The system is simulated forward in time using a simple while loop. First, two
lists are initialized to hold all of the time values and configuration values
for the simulation. Next, it enters a loop that says to continue until the
variational integrator reaches the final time. In each interation of the loop
the system is integrated forward by one time step. Then the new values are
append to the storage vectors.</p>
<p>The variational integrator object has attributes for times, configurations, and
discrete generalized momenta at both time points of the current integration
(e.g. <tt class="docutils literal"><span class="pre">mvi.t1</span></tt>, <tt class="docutils literal"><span class="pre">mvi.q1</span></tt>, and <tt class="docutils literal"><span class="pre">mvi.p1</span></tt>). The <a class="reference internal" href="../ref/midpointvi.html#trep.MidpointVI.step" title="trep.MidpointVI.step"><tt class="xref py py-mod docutils literal"><span class="pre">trep.MidpointVI.step</span></tt></a>
method integrates the system forward from the current time endpoint to the time
given the in the first argument. The second argument specifies the input over
that time period. You can see above that the input is set to zero.</p>
</div>
<div class="section" id="visualize-the-system-in-action">
<h2>Visualize the system in action<a class="headerlink" href="#visualize-the-system-in-action" title="Permalink to this headline">¶</a></h2>
<p>Let us use trep&#8217;s visualization tools to see the system in action.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">trep</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">visualize_3d</span><span class="p">([</span> <span class="n">trep</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">VisualItem3D</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span> <span class="p">])</span>
</pre></div>
</div>
<p>Finally let&#8217;s create a visualization of the system being simulated. Only the
system object, the list of times, and the list of configurations are needed to
create the visualization.</p>
<p>The output that you should see on your screen is shown below.</p>
<img alt="../_images/pendulumSystem.gif" src="../_images/pendulumSystem.gif" />
<p><strong>Note:</strong> <em>This is an animated gif of captured screen shots. So it is slower and
lower-quality than what you will see.</em></p>
</div>
<div class="section" id="pendulumsystem-py-code">
<h2>pendulumSystem.py code<a class="headerlink" href="#pendulumsystem-py-code" title="Permalink to this headline">¶</a></h2>
<p>Below is the entire script used in this section of the tutorial.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43</pre></div></td><td class="code"><div class="highlight"><pre><span class="c"># pendulumSystem.py</span>

<span class="c"># Import necessary Python modules</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">pi</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">trep</span>
<span class="kn">from</span> <span class="nn">trep</span> <span class="kn">import</span> <span class="n">tx</span><span class="p">,</span> <span class="n">ty</span><span class="p">,</span> <span class="n">tz</span><span class="p">,</span> <span class="n">rx</span><span class="p">,</span> <span class="n">ry</span><span class="p">,</span> <span class="n">rz</span>

<span class="c"># Build a pendulum system</span>
<span class="n">m</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="c"># Mass of pendulum</span>
<span class="n">l</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="c"># Length of pendulum</span>
<span class="n">q0</span> <span class="o">=</span> <span class="mf">3.</span><span class="o">/</span><span class="mf">4.</span><span class="o">*</span><span class="n">pi</span> <span class="c"># Initial configuration of pendulum</span>
<span class="n">t0</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c"># Initial time</span>
<span class="n">tf</span> <span class="o">=</span> <span class="mf">5.0</span> <span class="c"># Final time</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c"># Timestep</span>

<span class="n">system</span> <span class="o">=</span> <span class="n">trep</span><span class="o">.</span><span class="n">System</span><span class="p">()</span> <span class="c"># Initialize system</span>

<span class="n">frames</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">rx</span><span class="p">(</span><span class="s">&#39;theta&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&quot;pendulumShoulder&quot;</span><span class="p">),</span> <span class="p">[</span>
        <span class="n">tz</span><span class="p">(</span><span class="o">-</span><span class="n">l</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&quot;pendulumArm&quot;</span><span class="p">,</span> <span class="n">mass</span><span class="o">=</span><span class="n">m</span><span class="p">)]]</span>
<span class="n">system</span><span class="o">.</span><span class="n">import_frames</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span> <span class="c"># Add frames</span>

<span class="c"># Add forces to the system</span>
<span class="n">trep</span><span class="o">.</span><span class="n">potentials</span><span class="o">.</span><span class="n">Gravity</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.8</span><span class="p">))</span> <span class="c"># Add gravity</span>
<span class="n">trep</span><span class="o">.</span><span class="n">forces</span><span class="o">.</span><span class="n">Damping</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="c"># Add damping</span>
<span class="n">trep</span><span class="o">.</span><span class="n">forces</span><span class="o">.</span><span class="n">ConfigForce</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="s">&#39;theta&#39;</span><span class="p">,</span> <span class="s">&#39;theta-torque&#39;</span><span class="p">)</span> <span class="c"># Add input</span>

<span class="c"># Create and initialize the variational integrator</span>
<span class="n">mvi</span> <span class="o">=</span> <span class="n">trep</span><span class="o">.</span><span class="n">MidpointVI</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
<span class="n">mvi</span><span class="o">.</span><span class="n">initialize_from_configs</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">q0</span><span class="p">]),</span> <span class="n">t0</span><span class="o">+</span><span class="n">dt</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">q0</span><span class="p">]))</span>

<span class="c"># Simulate the system forward</span>
<span class="n">T</span> <span class="o">=</span> <span class="p">[</span><span class="n">mvi</span><span class="o">.</span><span class="n">t1</span><span class="p">]</span> <span class="c"># List to hold time values</span>
<span class="n">Q</span> <span class="o">=</span> <span class="p">[</span><span class="n">mvi</span><span class="o">.</span><span class="n">q1</span><span class="p">]</span> <span class="c"># List to hold configuration values</span>
<span class="k">while</span> <span class="n">mvi</span><span class="o">.</span><span class="n">t1</span> <span class="o">&lt;</span> <span class="n">tf</span><span class="p">:</span>
    <span class="n">mvi</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">mvi</span><span class="o">.</span><span class="n">t2</span><span class="o">+</span><span class="n">dt</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">])</span> <span class="c"># Step the system forward by one time step</span>
    <span class="n">T</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mvi</span><span class="o">.</span><span class="n">t1</span><span class="p">)</span>
    <span class="n">Q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mvi</span><span class="o">.</span><span class="n">q1</span><span class="p">)</span>

<span class="c"># Visualize the system in action</span>
<span class="n">trep</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">visualize_3d</span><span class="p">([</span> <span class="n">trep</span><span class="o">.</span><span class="n">visual</span><span class="o">.</span><span class="n">VisualItem3D</span><span class="p">(</span><span class="n">system</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span> <span class="p">])</span>
</pre></div>
</td></tr></table></div>
</div>
</div>


          </div>
        </div>
      </div>

      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
    <h2><a href="http://murpheylab.github.io/trep/">Project Website</a></h2>

  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Create a pendulum</a><ul>
<li><a class="reference internal" href="#import-necessary-python-modules">Import necessary Python modules</a></li>
<li><a class="reference internal" href="#build-a-pendulum-system">Build a pendulum system</a></li>
<li><a class="reference internal" href="#add-forces-to-the-system">Add forces to the system</a></li>
<li><a class="reference internal" href="#create-and-initialize-the-variational-integrator">Create and initialize the variational integrator</a></li>
<li><a class="reference internal" href="#simulate-the-system-forward">Simulate the system forward</a></li>
<li><a class="reference internal" href="#visualize-the-system-in-action">Visualize the system in action</a></li>
<li><a class="reference internal" href="#pendulumsystem-py-code">pendulumSystem.py code</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="trepHelloWorld.html"
                        title="previous chapter">Trep &#8220;Hello World&#8221;</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="linearFeedbackController.html"
                        title="next chapter">Design linear feedback controller</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/tutorial/pendulumSystem.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="linearFeedbackController.html" title="Design linear feedback controller"
             >next</a> |</li>
        <li class="right" >
          <a href="trepHelloWorld.html" title="Trep “Hello World”"
             >previous</a> |</li>
        <li><a href="../index.html">trep documentation</a> &raquo;</li>
          <li><a href="index.html" >Tutorial</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Elliot Johnson.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>